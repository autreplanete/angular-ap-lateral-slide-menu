/*!
 * angular-ap-lateral-slide-menu v0.0.1 (https://github.com/autreplanete/angular-ap-lateral-slide-menu)
 * Copyright 1994-2016 Autre planete
* 
*            .                                     .                                  
* .  *               *   *             .                          .       .       *   
*        .  *                     *   *    .  *      ,:      .        *     .    .    
*                           *                      ,' |     .     *                   
*  *   .        *       .       .       *         /   :                               
*                                              --'   /                .         .     
*     .  *                       *              / />/                                 
*             *                                / <//_\                 .     -o-      
*  *   .         \:/    .       .       *   __/   /                                   
*                 O                         )'-. /             .                .     
*                    .                      ./  :\                                    
*        *   .                .             /.' '                                     
*                                          '/'       .  *           *                 
*               .                         +                    .                      
*       *                     .           '                                .          
*                                       `.                                            
*               *                   .-"-             .                       .        
*                                  (    |                                             
*           .                   . .-'  '.                          *                  
*                              ( (.   )A:                                             
*                          .'    / (_  )                                  -o-         
*                           _. :(.   )AP  `                 .                         
*     *   .            .  (  `-' (  `.   .                                            
*                        .  :  (   .APx)                                              
*                       /_`( "a `a. )"'                                               
*                   (  (/  .  ' )=='       .  *                             *         
*                  (   (    )  .A"   +                                                
*                    (`'AP.( _(   (                                                   
*                 ..-. `AP    ) `  )  +                                               
*               -'   (      +aP:  )                                                   
*             '    _  `    (AP.cx                    *                                
*           _(    (    )b  -`.  ) +                                                   
*           )/    (AP   (AP    )  )                                                   
*           (  (/  .  ' )  ' ) )                                                      
*            .  (  `-' (  `.  .                                                       
*            ( (.   )    )                                                            
*               (    |                                                                
* 
 */
!function(){"use strict";var a=angular.module("ap.lateralSlideMenu",[]),b=b||!1;a.constant("menuConfig",{openClass:"lateral-slide-menu-is-open",inTransitionClass:"lateral-slide-menu-in-transition"}),a.service("menuService",["$document",function(a){var c=null;this.open=function(f){void 0!==window.StatusBar&&b.hide(),c||(a.bind("click",d),a.bind("keydown",e)),c&&c!==f&&(c.isOpen=!1),c=f},this.close=function(f){c===f&&(c=null,a.unbind("click",d),a.unbind("keydown",e)),void 0!==window.StatusBar&&b.show()};var d=function(){},e=function(a){27===a.which&&(c.focusToggleElement(),d())}}]),a.controller("MenuController",["$scope","$attrs","$parse","menuConfig","menuService","$timeout","$animate","$window",function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=this,o=a.$new(),p=d.openClass,q=d.inTransitionClass,r=angular.noop,s=b.onToggle?c(b.onToggle):angular.noop,t="";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?(t="-webkit-",j="WebkitTransition",k="webkitTransitionEnd transitionend"):(j="transition",k="transitionend"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend?(t="-webkit-",l="WebkitAnimation",m="webkitAnimationEnd animationend"):(l="animation",m="animationend");var u="Duration",v="Delay",w="IterationCount",x=null,y=function(a){if(!x){var b=0,c=0,d=0,e=0;angular.forEach(a,function(a){if(1==a.nodeType){var f=h.getComputedStyle(a)||{},g=f[j+u];b=Math.max(z(g),b);var i=f[j+v];c=Math.max(z(i),c);{f[l+v]}e=Math.max(z(f[l+v]),e);var k=z(f[l+u]);k>0&&(k*=parseInt(f[l+w],10)||1),d=Math.max(k,d)}}),x={total:0,transitionDelay:c,transitionDuration:b,animationDelay:e,animationDuration:d}}return x},z=function(a){var b=0,c=angular.isString(a)?a.split(/\s*,\s*/):[];return angular.forEach(c,function(a){b=Math.max(parseFloat(a)||0,b)}),b};this.init=function(d){n.$element=d,n.page=angular.element(document.getElementsByClassName("lateral-slide-menu-main-page")),b.isOpen&&(i=c(b.isOpen),r=i.assign,a.$watch(i,function(a){o.isOpen=!!a}))},this.toggle=function(a){return o.isOpen=arguments.length?!!a:!o.isOpen,o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return n.toggleElement},o.focusToggleElement=function(){n.toggleElement&&n.toggleElement[0].focus()},o.$watch("isOpen",function(b,c){if(b)n.$element.addClass(p),n.$element.addClass(q),o.focusToggleElement(),e.open(o);else{n.$element.removeClass(p);var d=y(n.page),g=Math.max(d.transitionDuration,d.animationDuration);f(function(){n.$element.removeClass(q)},1e3*g),e.close(o)}r(a,b),angular.isDefined(b)&&b!==c&&s(a,{open:!!b})}),a.$on("$routeChangeSuccess",function(){o.isOpen=!1}),a.$on("$stateChangeSuccess",function(){o.isOpen=!1}),a.$on("$locationChangeSuccess",function(){o.isOpen=!1}),a.$on("$destroy",function(){o.$destroy()})}]),a.directive("lateralSlideMenuController",function(){return{controller:"MenuController",restrict:"AE",link:function(a,b,c,d){d.init(b)}}}),a.directive("lateralSlideMenu",function(){return{require:"^lateralSlideMenuController",restrict:"AE",transclude:!0,template:'<nav class="lateral-slide-menu"><div class="lateral-slide-menu-scrollable-container" ng-transclude></div></nav><div class="lateral-slide-menu-overlay" lateral-slide-menu-toggle></div>'}}),a.directive("lateralSlideMenuToggle",["$timeout","$rootElement",function(a,b){function c(a,b,c,d){return Math.abs(a-c)<o&&Math.abs(b-d)<o}function d(a,b,d){for(var e=0;e<a.length;e+=2)if(c(a[e],a[e+1],b,d))return a.splice(e,e+2),!0;return!1}function e(a){if(!(Date.now()-h>n)){var b=a.touches&&a.touches.length?a.touches:[a],c=b[0].clientX,e=b[0].clientY;1>c&&1>e||j&&j[0]===c&&j[1]===e||(j&&(j=null),"label"===nodeName_(a.target)&&(j=[c,e]),d(i,c,e)||(a.stopPropagation(),a.preventDefault(),a.target&&a.target.blur&&a.target.blur()))}}function f(b){var c=b.touches&&b.touches.length?b.touches:[b],d=c[0].clientX,e=c[0].clientY;i.push(d,e),a(function(){for(var a=0;a<i.length;a+=2)if(i[a]==d&&i[a+1]==e)return void i.splice(a,a+2)},n,!1)}function g(a,c){i||(b[0].addEventListener("click",e,!0),b[0].addEventListener("touchstart",f,!0),i=[]),h=Date.now(),d(i,a,c)}var h,i,j,k="menu-click-active",l=750,m=12,n=2500,o=25;return{require:"^lateralSlideMenuController",restrict:"AE",link:function(a,b,c,d){function e(){tapping=!1,b.removeClass(k)}if(d){d.toggleElement=b;var f=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.on("touchstart",function(a){tapping=!0,tapElement=a.target?a.target:a.srcElement,3==tapElement.nodeType&&(tapElement=tapElement.parentNode),b.addClass(k),startTime=Date.now();var c=a.originalEvent||a,d=c.touches&&c.touches.length?c.touches:[c],e=d[0];touchStartX=e.clientX,touchStartY=e.clientY}),b.on("touchcancel",function(){e()}),b.on("touchend",function(a){var d=Date.now()-startTime,f=a.originalEvent||a,h=f.changedTouches&&f.changedTouches.length?f.changedTouches:f.touches&&f.touches.length?f.touches:[f],i=h[0],j=i.clientX,k=i.clientY,n=Math.sqrt(Math.pow(j-touchStartX,2)+Math.pow(k-touchStartY,2));tapping&&l>d&&m>n&&(g(j,k),tapElement&&tapElement.blur(),angular.isDefined(c.disabled)&&c.disabled===!1&&b.triggerHandler("click",[a])),e()}),b.onclick=function(){},b.on("click",f),b.on("mousedown",function(){b.addClass(k)}),b.on("mousemove mouseup",function(){b.removeClass(k)}),b.addClass("lateral-slide-menu-toggle"),b.attr({"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.off("click",f)})}}}}])}();